(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[67],{6041:function(e,a,t){Promise.resolve().then(t.bind(t,8095))},8095:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var s=t(7437),n=t(605),r=t(9376),i=t(2265),l=t(9820),c=t(2381),o=t(279),d=t(5060),u=t(9174),m=t(9397),x=t(5805),f=t(2208),h=t(7404),p=t(3774),g=t(8867),j=t(6362),b=t(4630),v=t(8930),y=t(2735),N=t(4291),w=t(5398);function k(){let{data:e,status:a}=(0,n.useSession)();(0,r.useRouter)();let[t,k]=(0,i.useState)([]),[C,z]=(0,i.useState)(!0),[Z,R]=(0,i.useState)(!1),[M,S]=(0,i.useState)(!1),[T,_]=(0,i.useState)(null),[A,q]=(0,i.useState)(null),[E,O]=(0,i.useState)({number:"",capacity:"",location:""});(0,i.useEffect)(()=>{if("loading"!==a){if(!e){window.location.href="https://portal.siparisqr.com/login";return}V()}},[e,a]);let V=async()=>{try{let e=await fetch("/api/tables");if(e.ok){let a=await e.json();k(a)}}catch(e){console.error("Tables fetch error:",e)}finally{z(!1)}},Y=async e=>{e.preventDefault();try{let e=T?"/api/tables/".concat(T.id):"/api/tables";(await fetch(e,{method:T?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...E,capacity:parseInt(E.capacity)})})).ok&&(V(),R(!1),D())}catch(e){console.error("Table save error:",e)}},I=async e=>{if(confirm("Bu masayı silmek istediğinizden emin misiniz?"))try{(await fetch("/api/tables/".concat(e),{method:"DELETE"})).ok&&V()}catch(e){console.error("Table delete error:",e)}},K=async(e,a)=>{try{(await fetch("/api/tables/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:a})})).ok&&V()}catch(e){console.error("Table status update error:",e)}},D=()=>{O({number:"",capacity:"",location:""}),_(null)},P=e=>{e?(_(e),O({number:e.number,capacity:e.capacity.toString(),location:e.location||""})):D(),R(!0)},B=e=>{q(e),S(!0)},Q=e=>"https://".concat("demo",".siparisqr.com/masa/").concat(e.number),F=e=>{navigator.clipboard.writeText(e)},L=e=>{let a=document.createElement("canvas"),t=a.getContext("2d"),s=document.querySelector("#qr-".concat(e.id));if(s&&t){let n=new XMLSerializer().serializeToString(s),r=new Image;r.onload=()=>{a.width=r.width,a.height=r.height,t.drawImage(r,0,0);let s=document.createElement("a");s.download="masa-".concat(e.number,"-qr.png"),s.href=a.toDataURL(),s.click()},r.src="data:image/svg+xml;base64,"+btoa(n)}};return"loading"===a||C?(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,s.jsx)("div",{className:"grid gap-4",children:[...Array(6)].map((e,a)=>(0,s.jsx)("div",{className:"h-32 bg-gray-200 rounded"},a))})]})}):e?(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Masa Y\xf6netimi"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Masalarınızı y\xf6netin ve QR kodlarını oluşturun"})]}),(0,s.jsx)(N.Vq,{open:Z,onOpenChange:R,children:(0,s.jsx)(N.hg,{asChild:!0,children:(0,s.jsxs)(c.z,{onClick:()=>P(),children:[(0,s.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Masa Ekle"]})})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,s.jsx)(l.Zb,{children:(0,s.jsx)(l.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Masa"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:t.length})]}),(0,s.jsx)(x.Z,{className:"h-8 w-8 text-blue-600"})]})})}),(0,s.jsx)(l.Zb,{children:(0,s.jsx)(l.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Aktif Masa"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:t.filter(e=>e.isActive).length})]}),(0,s.jsx)(f.Z,{className:"h-8 w-8 text-green-600"})]})})}),(0,s.jsx)(l.Zb,{children:(0,s.jsx)(l.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Kapasite"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:t.reduce((e,a)=>e+a.capacity,0)})]}),(0,s.jsx)(x.Z,{className:"h-8 w-8 text-purple-600"})]})})}),(0,s.jsx)(l.Zb,{children:(0,s.jsx)(l.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"QR Kodları"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:t.length})]}),(0,s.jsx)(h.Z,{className:"h-8 w-8 text-orange-600"})]})})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.map(e=>(0,s.jsx)(l.Zb,{className:e.isActive?"":"opacity-60",children:(0,s.jsxs)(l.aY,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:["Masa ",e.number]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[(0,s.jsx)(x.Z,{className:"h-3 w-3 mr-1"}),e.capacity," kişi"]}),e.location&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[(0,s.jsx)(p.Z,{className:"h-3 w-3 mr-1"}),e.location]})]}),(0,s.jsx)(u.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Aktif":"Pasif"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>B(e),children:[(0,s.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"QR"]}),(0,s.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>F(Q(e)),children:[(0,s.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Link"]}),(0,s.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>window.open(Q(e),"_blank"),children:[(0,s.jsx)(j.Z,{className:"h-3 w-3 mr-1"}),"A\xe7"]})]}),(0,s.jsx)("div",{className:"flex justify-between items-center mt-4 pt-3 border-t",children:(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)(c.z,{size:"sm",variant:"ghost",onClick:()=>K(e.id,!e.isActive),children:(0,s.jsx)(f.Z,{className:"h-3 w-3"})}),(0,s.jsx)(c.z,{size:"sm",variant:"ghost",onClick:()=>P(e),children:(0,s.jsx)(b.Z,{className:"h-3 w-3"})}),(0,s.jsx)(c.z,{size:"sm",variant:"ghost",onClick:()=>I(e.id),children:(0,s.jsx)(v.Z,{className:"h-3 w-3"})})]})})]})},e.id))}),(0,s.jsx)(N.Vq,{open:Z,onOpenChange:R,children:(0,s.jsxs)(N.cZ,{className:"sm:max-w-md",children:[(0,s.jsxs)(N.fK,{children:[(0,s.jsx)(N.$N,{children:T?"Masa D\xfczenle":"Yeni Masa Ekle"}),(0,s.jsx)(N.Be,{children:T?"Masa bilgilerini g\xfcncelleyin":"Yeni bir masa ekleyin"})]}),(0,s.jsxs)("form",{onSubmit:Y,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(d._,{htmlFor:"table-number",children:"Masa Numarası"}),(0,s.jsx)(o.I,{id:"table-number",value:E.number,onChange:e=>O({...E,number:e.target.value}),placeholder:"\xf6rn: 1, A1, VIP-1",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(d._,{htmlFor:"table-capacity",children:"Kapasite (Kişi)"}),(0,s.jsx)(o.I,{id:"table-capacity",type:"number",min:"1",value:E.capacity,onChange:e=>O({...E,capacity:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(d._,{htmlFor:"table-location",children:"Konum (Opsiyonel)"}),(0,s.jsx)(o.I,{id:"table-location",value:E.location,onChange:e=>O({...E,location:e.target.value}),placeholder:"\xf6rn: Pencere kenarı, Balkon, İ\xe7 salon"})]}),(0,s.jsxs)(N.cN,{children:[(0,s.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>R(!1),children:"İptal"}),(0,s.jsx)(c.z,{type:"submit",children:T?"G\xfcncelle":"Ekle"})]})]})]})}),(0,s.jsx)(N.Vq,{open:M,onOpenChange:S,children:(0,s.jsxs)(N.cZ,{className:"sm:max-w-md",children:[(0,s.jsxs)(N.fK,{children:[(0,s.jsxs)(N.$N,{children:["QR Kod - Masa ",null==A?void 0:A.number]}),(0,s.jsx)(N.Be,{children:"M\xfcşteriler bu QR kodu okutarak men\xfcye erişebilir"})]}),A&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-center p-4 bg-white border rounded",children:(0,s.jsx)(w.t,{id:"qr-".concat(A.id),value:Q(A),size:200,level:"M",includeMargin:!0})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{children:"Men\xfc URL'si"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(o.I,{value:Q(A),readOnly:!0,className:"text-sm"}),(0,s.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>F(Q(A)),children:(0,s.jsx)(g.Z,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)(c.z,{className:"flex-1",onClick:()=>L(A),children:[(0,s.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"QR İndir"]}),(0,s.jsxs)(c.z,{variant:"outline",className:"flex-1",onClick:()=>window.open(Q(A),"_blank"),children:[(0,s.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Men\xfcy\xfc A\xe7"]})]})]}),(0,s.jsx)(N.cN,{children:(0,s.jsx)(c.z,{onClick:()=>S(!1),children:"Kapat"})})]})})]}):null}},9174:function(e,a,t){"use strict";t.d(a,{C:function(){return l}});var s=t(7437);t(2265);var n=t(535),r=t(3448);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:a,variant:t,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)(i({variant:t}),a),...n})}},2381:function(e,a,t){"use strict";t.d(a,{z:function(){return o}});var s=t(7437),n=t(2265),r=t(7495),i=t(535),l=t(3448);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,a)=>{let{className:t,variant:n,size:i,asChild:o=!1,...d}=e,u=o?r.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(c({variant:n,size:i,className:t})),ref:a,...d})});o.displayName="Button"},9820:function(e,a,t){"use strict";t.d(a,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var s=t(7437),n=t(2265),r=t(3448);let i=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});i.displayName="Card";let l=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...n})});l.displayName="CardHeader";let c=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});c.displayName="CardTitle";let o=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",t),...n})});o.displayName="CardDescription";let d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",t),...n})});d.displayName="CardContent",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},4291:function(e,a,t){"use strict";t.d(a,{$N:function(){return h},Be:function(){return p},Vq:function(){return c},cN:function(){return f},cZ:function(){return m},fK:function(){return x},hg:function(){return o}});var s=t(7437),n=t(2265),r=t(9027),i=t(2489),l=t(3448);let c=r.fC,o=r.xz,d=r.h_;r.x8;let u=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.aV,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});u.displayName=r.aV.displayName;let m=n.forwardRef((e,a)=>{let{className:t,children:n,...c}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(r.VY,{ref:a,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[n,(0,s.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.VY.displayName;let x=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};x.displayName="DialogHeader";let f=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};f.displayName="DialogFooter";let h=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.Dx,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});h.displayName=r.Dx.displayName;let p=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.dk,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...n})});p.displayName=r.dk.displayName},279:function(e,a,t){"use strict";t.d(a,{I:function(){return i}});var s=t(7437),n=t(2265),r=t(3448);let i=n.forwardRef((e,a)=>{let{className:t,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...i})});i.displayName="Input"},5060:function(e,a,t){"use strict";t.d(a,{_:function(){return o}});var s=t(7437),n=t(2265),r=t(6394),i=t(535),l=t(3448);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.f,{ref:a,className:(0,l.cn)(c(),t),...n})});o.displayName=r.f.displayName},3448:function(e,a,t){"use strict";t.d(a,{cn:function(){return r}});var s=t(1994),n=t(3335);function r(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,n.m6)((0,s.W)(a))}}},function(e){e.O(0,[697,605,861,346,971,117,744],function(){return e(e.s=6041)}),_N_E=e.O()}]);